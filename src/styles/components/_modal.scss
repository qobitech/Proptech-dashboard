$duration: 0.35s;
$ease: cubic-bezier(0.22, 1, 0.36, 1);

%discrete-transition {
	transition:
		opacity $duration $ease,
		transform $duration $ease,
		display $duration $ease allow-discrete,
		overlay $duration $ease allow-discrete;
}

.bt_modal_mask {
	position: fixed;
	inset: 0;
	z-index: 999999;
	background: rgba(15, 46, 56, 0.9);

	display: none;
	opacity: 0;
	overflow: auto;

	transition:
		opacity $duration $ease,
		display $duration $ease $duration allow-discrete,
		overlay $duration $ease $duration allow-discrete;

	&.bt_modal_state--open {
		display: block;
		opacity: 1;
		transition:
			opacity $duration $ease 0.05s,
			display $duration $ease 0.05s allow-discrete,
			overlay $duration $ease 0.05s allow-discrete;

		// nosonar
		@starting-style {
			opacity: 0;
		}
	}

	&:not(.bt_modal_state--open) {
		transition:
			opacity $duration $ease $duration,
			display $duration $ease $duration allow-discrete,
			overlay $duration $ease $duration allow-discrete;
	}
}

.bt_modal_container {
	position: fixed;
	inset: 0;
	z-index: 999999;
	display: none;
	align-items: center;
	overflow: auto;
	opacity: 0;
	@extend %discrete-transition;

	&:has(.bt_popover_container .bt_popover_is-open) {
		z-index: 103;
	}

	&.bt_modal_state--open {
		opacity: 1;
		display: flex;
		transition-delay: 0s;

		// nosonar
		@starting-style {
			opacity: 0;
		}
	}

	& > .bt_modal_content {
		width: 95%;
		max-width: 57rem;
		margin: auto;
		border-radius: 1.6rem;

		transform: scale(0.96) translateY(2rem);
		opacity: 0;
		transition:
			transform $duration $ease,
			opacity $duration $ease;

		.bt_modal_content_header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			column-gap: 2rem;
			margin-bottom: 1.7rem;
			position: relative;

			svg {
				margin-left: auto;
				position: absolute;
				right: 0;
				top: -10;
				cursor: pointer;
			}
		}

		.bt_modal_content_body {
			height: 100%;

			& > div {
				max-height: 87svh;
			}
		}
	}

	&.bt_modal_state--open > .bt_modal_content {
		transform: scale(1) translateY(0);
		opacity: 1;

		// nosonar
		@starting-style {
			transform: scale(0.96) translateY(2rem);
			opacity: 0;
		}
	}

	&.right-sheet {
		justify-content: flex-end;
		align-items: stretch;

		& ~ .bt_modal_mask {
			transition-delay: 0s;
		}

		.bt_modal_content {
			width: 45.7rem;
			max-width: 100%;
			height: 100svh;
			margin: 0;
			border-radius: 0;
			background: var(--color-neutral-50);

			transform: translateX(100%);
			opacity: 1;
			transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);

			@media (max-width: 768px) {
				width: 100%;
			}
		}

		&.bt_modal_state--open .bt_modal_content {
			transform: translateX(0);

			// nosonar
			@starting-style {
				transform: translateX(100%);
			}
		}

		.bt_modal_content_header {
			position: relative;
			height: 3.5rem;
			background: var(--color-neutral-50);
			margin-bottom: 0;

			svg {
				position: absolute;
				left: -5rem;
				top: 1rem;
				margin: 0;
			}
		}

		.bt_modal_content_body {
			height: calc(100svh - 3.5rem);
			overflow: hidden;
		}
	}

	&.full-screen {
		.bt_modal_content {
			width: 100%;
			max-width: 100%;
			height: 100svh;
			margin: 0;
			border-radius: 0;
			background: var(--color-neutral-50);
		}
	}
}

.right-sheet {
	&_header {
		height: 4.8rem;
		padding: 0.7rem 2.4rem;
		background: var(--color-neutral-50);
		display: flex;
		align-items: center;
		border-bottom: 0.1rem solid var(--color-neutral-300);
		position: relative;

		h3 {
			font-family: var(--paralucent-medium);
			font-weight: 500;
			font-size: 1.8rem;
			line-height: 3.2rem;
			text-align: center;
			color: var(--color-primary-400);
			margin: auto;
		}

		svg {
			position: absolute;
			box-sizing: content-box;
			left: 0;
			padding: 0 2.4rem;
		}
	}

	&_content {
		box-sizing: border-box;
		padding: 3rem 2.4rem 2.4rem;
		height: 90svh;
		overflow: auto;
	}

	&_cta {
		position: absolute;
		background: var(--color-neutral-50);
		box-shadow: 0 0.4rem 5rem 0.5rem var(--translucent-dark-blue-gray);
		box-sizing: border-box;
		padding: 2rem 2.4rem;
		width: 100%;
		bottom: 0;
		left: 0;
		display: flex;
		align-items: center;
		gap: 2rem;

		&_fullwidth {
			width: 100%;
		}
	}

	&_hide-stage {
		display: none;
	}
}

@media (max-width: 1100px) {
	.right-sheet {
		&_header {
			height: auto;
			padding: 1.4rem 2.4rem;
			position: relative;
		}

		&_navigator_hide,
		&_navigator {
			box-sizing: content-box;
			left: 0;
			padding: 0 2.4rem;
			position: absolute;
		}
	}
}

@media (min-width: 768px) {
	.right-sheet {
		&_navigator {
			&_hide {
				display: none;
			}
		}
	}
}

.modal-loader {
	border-radius: 2.5rem;
	background: var(--color-neutral-50);
	overflow: hidden;
}

[data-theme='dark'] {
	.bt_modal_container {
		&.right-sheetopen,
		&.right-sheetclose {
			.bt_modal_content_header {
				background: var(--color-primary-500);
			}

			.bt_modal_content {
				background: var(--color-primary-500);
			}
		}
	}

	.bt_modal_content_header {
		svg rect {
			stroke: none;
		}
		svg path {
			fill: var(--color-neutral-50);
		}
	}
}
